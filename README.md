# CDC with Kafka, PostgreSQL, and Debezium

This project sets up a Kafka environment to stream data from two PostgreSQL databases: Hasan Sadikin Hospital and Borromeus Hospital, using Debezium connectors.

## Getting Started

1.	Start the Services
Run the following command to start all services and configure the Kafka connectors:

   `make setup`


2.	Connect between the DB and Kafka using the `connect.sh` script. This script will post the Kafka connectors to the Kafka Connect service which will then stream the data changes in the DB to Kafka.

   `./connect.sh`

3. Stop the Services
To stop all running services, use:

   `make down`


## Listening to Topics

The following topics are autogenerated by the Kafka connectors and can be consumed to access real-time data:

•	hasan-sadikin-hospital.public.availabilities

•	borromeus-hospital.public.availabilities

Use a Kafka consumer to read messages, for example:

`kafka-console-consumer --bootstrap-server localhost:9092 --topic <topic-name> --from-beginning` (run from docker exec)

Replace <topic-name> with the desired topic.


### Processing Messages
1. View the message example in `./response.json`
2. Can refer to the `payload` field in the JSON. There are three cases:
- If before is null, and after is not null, it is an `INSERT` operation
- if before is not null, and after is null, it is an `DELETE` operation
- if before and after are not null, it is an `UPDATE` operation
3. Update data in DB accordingly.

## Contributors
- [Eugene Yap Jin Quan](https://github.com/yuujin-Q)
- [Jeffrey Chow](https://github.com/JeffreyChow19)
- [Jimly Firdaus](https://github.com/Jimly-Firdaus)
- [Rachel Gabriela Chen](https://github.com/chaerla)
